{% extends 'base.html' %}

{% block title %}Xu h∆∞·ªõng t·∫°i M√®o V·∫°c, H√† Giang{% endblock %}

{% block head %}
    <style>
        .header-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .refresh-btn { background-color: #17a2b8; color: white; padding: .75rem 1.5rem; border: none; border-radius: 5px; font-size: 1rem; cursor: pointer; text-decoration: none; }
        .refresh-btn:hover { background-color: #138496; }
        .results-container { margin-top: 2rem; }
        .result-section { background-color: #fff; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h3 { border-bottom: 2px solid #eee; padding-bottom: .5rem; }
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        th, td { text-align: left; padding: .75rem; border-bottom: 1px solid #ddd; }
        th { background-color: #f2f2f2; }
    </style>
{% endblock %}

{% block content %}
    <div class="header-container">
        <h1>Ph√¢n t√≠ch Xu h∆∞·ªõng: M√®o V·∫°c, H√† Giang</h1>
        <a href="{{ url_for('trang_xu_huong') }}" class="refresh-btn">C·∫≠p nh·∫≠t & Ph√¢n t√≠ch l·∫°i</a>
    </div>
    
    {% if results and not results.error %}
    <div class="results-container">
        
        {% if results.top_keyword %}
        <div class="result-section">
            <h3>üî• Lo·∫°i h√¨nh ƒë∆∞·ª£c quan t√¢m nh·∫•t trong th√°ng qua</h3>
            <p style="font-size: 1.2rem; font-weight: bold;">{{ results.top_keyword }}</p>
        </div>
        {% endif %}

        {% if results.rising_queries and not results.rising_queries.empty %}
        <div class="result-section">
            <h3>üí° C√°c truy v·∫•n ƒëang TƒÇNG M·∫†NH (Nhu c·∫ßu m·ªõi n·ªïi)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Truy v·∫•n</th>
                        <th>M·ª©c tƒÉng</th>
                    </tr>
                </thead>
                <tbody>
                    {% for index, row in results.rising_queries.iterrows() %}
                    <tr>
                        <td>{{ row.query }}</td>
                        <td>+{{ row.value }}%</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% elif not results.top_keyword %}
        <p>Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu v·ªÅ c√°c truy v·∫•n ƒëang tƒÉng m·∫°nh.</p>
        {% endif %}

        {% if results.top_queries and not results.top_queries.empty %}
        <div class="result-section">
            <h3>‚≠ê C√°c truy v·∫•n PH·ªî BI·∫æN NH·∫§T (Nhu c·∫ßu c·ªët l√µi)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Truy v·∫•n</th>
                        <th>M·ª©c ƒë·ªô ph·ªï bi·∫øn (0-100)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for index, row in results.top_queries.iterrows() %}
                    <tr>
                        <td>{{ row.query }}</td>
                        <td>{{ row.value }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% elif not results.top_keyword %}
         <p>Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu v·ªÅ c√°c truy v·∫•n ph·ªï bi·∫øn.</p>
        {% endif %}
    </div>
    {% elif error %}
        <div class="results-container">
            <p style="color: red; font-weight: bold;">L·ªói: {{ error }}</p>
        </div>
    {% else %}
        <div class="results-container">
            <p>Kh√¥ng c√≥ ƒë·ªß d·ªØ li·ªáu ƒë·ªÉ ph√¢n t√≠ch cho khu v·ª±c n√†y.</p>
        </div>
    {% endif %}
{% endblock %}
